-- CREATE TABLE SPORTS(sportsId int NOT NULL, sportsName nchar(50) NOT NULL);
-- CREATE TABLE PLAYERS(playerId int NOT NULL, playerName nchar(50) NOT NULL, collegeId int);
-- CREATE TABLE COLLEGE(collegeId int NOT NULL, collegeName nchar(50) NOT NULL);
-- CREATE TABLE TOURNAMENTS(tournamentId int NOT NULL, tournamentName nchar(50) NOT NULL, collegeId int);
-- CREATE TABLE SCOREBOARD(studentId int NOT NULL, tournamentId int NOT NULL, score int);
-- CREATE TABLE TOURNAMENTSPORTS(tournamentId int NOT NULL,sportsID int NOT NULL);
-- CREATE TABLE TEAM(teamId int NOT NULL PRIMARY KEY,teamName nchar(50) NOT NULL);

ALTER TABLE SCOREBOARD ADD sportsID int NOT NULL;
ALTER TABLE SCOREBOARD DROP COLUMN studentId;
ALTER TABLE SCOREBOARD ADD playerID int NOT NULL;

ALTER TABLE SPORTS ADD Type nchar(50);

ALTER TABLE PLAYERS ADD teamId int;

ALTER TABLE PLAYERS ADD CONSTRAINT fk_player_team FOREIGN KEY (teamID) REFERENCES TEAM(teamID);

ALTER TABLE SPORTS ADD PRIMARY KEY(sportsID);
ALTER TABLE TOURNAMENTS ADD PRIMARY KEY(tournamentId);
ALTER TABLE PLAYERS ADD PRIMARY KEY(playerId);
ALTER TABLE COLLEGE ADD PRIMARY KEY(collegeId);

ALTER TABLE TOURNAMENTS ADD CONSTRAINT fk_tournament_college FOREIGN KEY (collegeId) REFERENCES COLLEGE(collegeID);
ALTER TABLE PLAYERS ADD CONSTRAINT fk_player_college FOREIGN KEY (collegeId) REFERENCES COLLEGE(collegeID);
ALTER TABLE TOURNAMENTSPORTS ADD CONSTRAINT fk_tournament FOREIGN KEY (tournamentID) REFERENCES TOURNAMENTS(tournamentID);
ALTER TABLE TOURNAMENTSPORTS ADD CONSTRAINT fk_sports FOREIGN KEY (sportsID) REFERENCES SPORTS(sportsID);

ALTER TABLE SCOREBOARD ADD CONSTRAINT fk_tournament_score FOREIGN KEY (tournamentID) REFERENCES TOURNAMENTS(tournamentID);
ALTER TABLE SCOREBOARD ADD CONSTRAINT fk_sports_score FOREIGN KEY (sportsID) REFERENCES SPORTS(sportsID);
ALTER TABLE SCOREBOARD ADD CONSTRAINT fk_player_score FOREIGN KEY (playerID) REFERENCES PLAYERS(playerID);

CREATE OR ALTER PROCEDURE removeCollege @collegeId int
AS
BEGIN
DECLARE @tournamentid int;
SELECT @tournamentid = tournamentId FROM TOURNAMENTS WHERE collegeId = @collegeId;
DELETE FROM PLAYERS WHERE collegeId = @collegeId;
EXEC removeTournament @tournamentid;
DELETE FROM COLLEGE WHERE collegeId = @collegeId;
END

CREATE OR ALTER PROCEDURE removeTournament @tournamentId int
AS
BEGIN
DELETE FROM TOURNAMENTSPORTS WHERE tournamentId = @tournamentId;
DELETE FROM TOURNAMENTS WHERE tournamentId = @tournamentId;
END

CREATE OR ALTER PROCEDURE removePlayer @playerId int
AS
BEGIN
DELETE FROM PLAYERS WHERE playerId = @playerId;
END

CREATE OR ALTER PROCEDURE removeSports @sportsId int
AS
BEGIN
DELETE FROM TOURNAMENTSPORTS WHERE sportsId = @sportsId;
DELETE FROM SPORTS WHERE sportsId = @sportsId;
END

-- DELETE FROM COLLEGE WHERE collegeId = 7822;

SELECT * FROM SPORTS;
SELECT * FROM PLAYERS;
SELECT * FROM COLLEGE;
SELECT * FROM TOURNAMENTS;
SELECT * FROM TOURNAMENTSPORTS;
SELECT * FROM TEAM;
SELECT * FROM SCOREBOARD;

INSERT INTO COLLEGE VALUES(7201, 'SKCT');
INSERT INTO COLLEGE VALUES(7202, 'SKCET');
INSERT INTO COLLEGE VALUES(7203, 'SASTRA');
INSERT INTO COLLEGE VALUES(7204, 'SATHYABAMA');
INSERT INTO COLLEGE VALUES(7205, 'SNS');
INSERT INTO COLLEGE VALUES(7206, 'KONGU');
INSERT INTO COLLEGE VALUES(7207, 'BIT');
INSERT INTO COLLEGE VALUES(7208, 'VELLAMAL');
INSERT INTO COLLEGE VALUES(7209, 'SONA');
INSERT INTO COLLEGE VALUES(7210, 'KUMARAGURU');

INSERT INTO PLAYERS VALUES(001,'Madhu',7201,NULL);
INSERT INTO PLAYERS VALUES(002,'Kiru',7202,NULL);
INSERT INTO PLAYERS VALUES(003,'Poovi',7203,NULL);
INSERT INTO PLAYERS VALUES(004,'Meenu',7204,NULL);
INSERT INTO PLAYERS VALUES(005,'Mona',7205,NULL);
INSERT INTO PLAYERS VALUES(006,'Maha',7206,NULL);
INSERT INTO PLAYERS VALUES(007,'Nitu',7207,NULL);
INSERT INTO PLAYERS VALUES(008,'Shiku',7208,NULL);
INSERT INTO PLAYERS VALUES(009,'Shan',7209,NULL);
INSERT INTO PLAYERS VALUES(010,'Sai',7210,NULL);
INSERT INTO PLAYERS VALUES(011,'Priya',7201,NULL);
INSERT INTO PLAYERS VALUES(012,'Sravani',7202,NULL);
INSERT INTO PLAYERS VALUES(013,'Kiruthi',7203,NULL);
INSERT INTO PLAYERS VALUES(014,'Paarkavi',7204,NULL);
INSERT INTO PLAYERS VALUES(015,'Nithin',7205,NULL);
INSERT INTO PLAYERS VALUES(016,'Adam',7206,NULL);

INSERT INTO TOURNAMENTSPORTS VALUES (1001,801);
INSERT INTO TOURNAMENTSPORTS VALUES (1001,804);
INSERT INTO TOURNAMENTSPORTS VALUES (1001,802);
INSERT INTO TOURNAMENTSPORTS VALUES (1001,803);
INSERT INTO TOURNAMENTSPORTS VALUES (1002,805);
INSERT INTO TOURNAMENTSPORTS VALUES (1002,806);
INSERT INTO TOURNAMENTSPORTS VALUES (1002,802);
INSERT INTO TOURNAMENTSPORTS VALUES (1003,801);
INSERT INTO TOURNAMENTSPORTS VALUES (1003,801);
INSERT INTO TOURNAMENTSPORTS VALUES (1003,801);

INSERT INTO TOURNAMENTS VALUES (1001,'SKCT INTERCOLLEGE FEST',7201);
INSERT INTO TOURNAMENTS VALUES (1002,'SKCET INTERCOLLEGE FEST',7202);
INSERT INTO TOURNAMENTS VALUES (1003,'SKCT SUMMER FEST',7201);
INSERT INTO TOURNAMENTS VALUES (1004,'SPORTS FEST',7203);
INSERT INTO TOURNAMENTS VALUES (1005,'OLYMPICS CHAMPS',7204);
INSERT INTO TOURNAMENTS VALUES (1006,'EXPLORATE',7205);
INSERT INTO TOURNAMENTS VALUES (1007,'SKCT WINTER FEST',7201);

INSERT INTO SPORTS VALUES (801,'KABADI','Team');
INSERT INTO SPORTS VALUES (802,'CRICKET','Team');
INSERT INTO SPORTS VALUES (803,'FOOTBALL','Team');
INSERT INTO SPORTS VALUES (804,'BASKETBALL','Team');
INSERT INTO SPORTS VALUES (805,'ARCHERY','Individual');
INSERT INTO SPORTS VALUES (806,'SHOOTING','Individual');
INSERT INTO SPORTS VALUES (807,'SKATING','Individual');
INSERT INTO SPORTS VALUES (808,'SWIMMING','Individual');

INSERT INTO TOURNAMENTS VALUES (1008,'DUMMY',7209);
INSERT INTO TOURNAMENTSPORTS VALUES(1008,801);
INSERT INTO TOURNAMENTSPORTS VALUES(1008,803);

SELECT * FROM SPORTS;
SELECT * FROM PLAYERS;
SELECT * FROM COLLEGE;
SELECT * FROM TOURNAMENTS;
SELECT * FROM TOURNAMENTSPORTS;
SELECT * FROM TEAM;
SELECT * FROM SCOREBOARD;

CREATE TABLE REGISTEREDINDIVIDUALS(playerId int NOT NULL,tournamentId int NOT NULL,sportsId int NOT NULL);
CREATE TABLE REGISTEREDTEAMS(teamId int NOT NULL,tournamentId int NOT NULL,sportsId int NOT NULL);


ALTER TABLE REGISTEREDINDIVIDUALS ADD CONSTRAINT fk_tournament_individual FOREIGN KEY (tournamentID) REFERENCES TOURNAMENTS(tournamentID);
ALTER TABLE REGISTEREDINDIVIDUALS ADD CONSTRAINT fk_sports_individual FOREIGN KEY (sportsID) REFERENCES SPORTS(sportsID);
ALTER TABLE REGISTEREDINDIVIDUALS ADD CONSTRAINT fk_player_individual FOREIGN KEY (playerID) REFERENCES PLAYERS(playerID);

ALTER TABLE REGISTEREDTEAMS ADD CONSTRAINT fk_tournament_team FOREIGN KEY (tournamentID) REFERENCES TOURNAMENTS(tournamentID);
ALTER TABLE REGISTEREDTEAMS ADD CONSTRAINT fk_sports_team FOREIGN KEY (sportsID) REFERENCES SPORTS(sportsID);
ALTER TABLE REGISTEREDTEAMS ADD CONSTRAINT fk_team_team FOREIGN KEY (teamID) REFERENCES TEAM(teamID);
